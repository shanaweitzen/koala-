 <!DOCTYPE html>
 <html>
	<head>
	  <title>Pusher Test</title>
	  <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
	  <script src="http://js.pusher.com/2.1/pusher.min.js" type="text/javascript"></script>
	  <script type="text/javascript">
	    $(document).ready(function(){
		    var pusher = new Pusher('5e4ecb05e15638c23f86');
		    var channel = pusher.subscribe('messages');

		 //    $('#send').click(function(e){
			// 	var message = $('form input[type="text"]').val();
			// 	console.log(message);
			// 	e.preventDefault();
			// });

		    // Enable pusher logging - don't include this in production
		    Pusher.log = function(message) {
		      if (window.console && window.console.log) {
		        window.console.log(message);
		      }
		    };

		    channel.bind('new_message', function(data) { //reading 
		    	$("#messageWindow li:last-child").append('<li>message</li>')
		  		// $('new_message').appendTo('#messageWindow') 
		  		alert('An event was triggered with message: ' + data.text);
		  		// $("#conn_status").text(pusher.connection.state);
		    });	

		});

	  </script>
	</head>

	<body>
		<div id="messageWindow">
			<ul>
				<% @messages.each do |message| %>
					<li><%= message.text %></li>
				<% end %>
			</ul>
		</div>
		<%= form_for :message, url: messages_path, method: :post, remote: true do |f| %>
			<%= f.text_field :text %>
			<%= f.submit %>
		<% end %>
	</body>

</html>